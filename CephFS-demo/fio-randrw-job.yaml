apiVersion: batch/v1
kind: Job
metadata:
  name: fio-rwx-test2
spec:
  completions: 3
  parallelism: 3
  backoffLimit: 0
  template:
    metadata:
      labels:
        app: fio-rwx-test2
    spec:
      restartPolicy: Never

      # Force pods onto different nodes
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchLabels:
                app: fio-rwx-test2
            topologyKey: kubernetes.io/hostname

      containers:
      - name: fio
        image: ljishen/fio
        command: ["fio"]
        args:
          - "--name=rwx-fair"
          - "--directory=/data"
          - "--filename=$(HOSTNAME).dat"
          - "--size=1Gi"

          # MIXED READ / WRITE
          - "--rw=randrw"
          - "--rwmixread=70"

          - "--bs=4k"
          - "--numjobs=4"
          - "--iodepth=16"
          - "--ioengine=libaio"
          - "--direct=1"
          - "--fsync=1"
          - "--runtime=60"
          - "--time_based"
          - "--group_reporting"

        volumeMounts:
        - name: rwx-vol
          mountPath: /data

      volumes:
      - name: rwx-vol
        persistentVolumeClaim:
          claimName: rwx-pvc




===== pod/fio-rwx-test2-9zm5t =====
rwx-fair: (g=0): rw=randrw, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=16
...
fio-3.6
Starting 4 processes

rwx-fair: (groupid=0, jobs=4): err= 0: pid=10: Tue Feb  3 06:51:48 2026
   read: IOPS=500, BW=2004KiB/s (2052kB/s)(118MiB/60046msec)
    slat (nsec): min=1865, max=11435k, avg=54293.55, stdev=252497.17
    clat (usec): min=2, max=242376, avg=10115.56, stdev=13062.50
     lat (usec): min=295, max=242391, avg=10171.35, stdev=13057.54
    clat percentiles (usec):
     |  1.00th=[   383],  5.00th=[   611], 10.00th=[   889], 20.00th=[  1713],
     | 30.00th=[  2999], 40.00th=[  4686], 50.00th=[  6915], 60.00th=[  9503],
     | 70.00th=[ 12387], 80.00th=[ 16057], 90.00th=[ 21890], 95.00th=[ 27657],
     | 99.00th=[ 53216], 99.50th=[ 71828], 99.90th=[181404], 99.95th=[214959],
     | 99.99th=[219153]
   bw (  KiB/s): min=   23, max= 1168, per=27.15%, avg=543.88, stdev=197.72, samples=442
   iops        : min=    5, max=  292, avg=135.82, stdev=49.43, samples=442
  write: IOPS=219, BW=879KiB/s (900kB/s)(51.5MiB/60046msec)
    slat (usec): min=2, max=7987, avg=63.49, stdev=262.33
    clat (msec): min=12, max=3053, avg=266.94, stdev=290.18
     lat (msec): min=13, max=3053, avg=267.01, stdev=290.18
    clat percentiles (msec):
     |  1.00th=[   26],  5.00th=[   41], 10.00th=[   58], 20.00th=[  114],
     | 30.00th=[  192], 40.00th=[  241], 50.00th=[  266], 60.00th=[  288],
     | 70.00th=[  305], 80.00th=[  326], 90.00th=[  359], 95.00th=[  401],
     | 99.00th=[ 1502], 99.50th=[ 2836], 99.90th=[ 3037], 99.95th=[ 3037],
     | 99.99th=[ 3037]
   bw (  KiB/s): min=    8, max=  416, per=27.34%, avg=240.06, stdev=76.93, samples=437
   iops        : min=    2, max=  104, avg=59.82, stdev=19.20, samples=437
  lat (usec)   : 4=0.03%, 10=0.02%, 20=0.01%, 50=0.03%, 100=0.03%
  lat (usec)   : 250=0.06%, 500=1.79%, 750=3.35%, 1000=3.00%
  lat (msec)   : 2=7.28%, 4=9.58%, 10=17.90%, 20=18.02%, 50=10.02%
  lat (msec)   : 100=3.75%, 250=7.94%, 500=16.35%, 750=0.37%, 1000=0.01%
  fsync/fdatasync/sync_file_range:
    sync (nsec): min=18, max=2607.6k, avg=351.50, stdev=13547.17
    sync percentiles (nsec):
     |  1.00th=[    22],  5.00th=[    24], 10.00th=[    40], 20.00th=[    47],
     | 30.00th=[    63], 40.00th=[   104], 50.00th=[   133], 60.00th=[   157],
     | 70.00th=[   185], 80.00th=[   233], 90.00th=[   338], 95.00th=[   458],
     | 99.00th=[   732], 99.50th=[   956], 99.90th=[ 13120], 99.95th=[ 91648],
     | 99.99th=[333824]
  cpu          : usr=0.26%, sys=0.51%, ctx=43734, majf=0, minf=59
  IO depths    : 1=0.1%, 2=0.1%, 4=0.1%, 8=0.1%, 16=199.7%, 32=0.0%, >=64=0.0%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.1%, 32=0.0%, 64=0.0%, >=64=0.0%
     issued rwts: total=30081,13193,0,43214 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=16

Run status group 0 (all jobs):
   READ: bw=2004KiB/s (2052kB/s), 2004KiB/s-2004KiB/s (2052kB/s-2052kB/s), io=118MiB (123MB), run=60046-60046msec
  WRITE: bw=879KiB/s (900kB/s), 879KiB/s-879KiB/s (900kB/s-900kB/s), io=51.5MiB (54.0MB), run=60046-60046msec

===== pod/fio-rwx-test2-msmcb =====
rwx-fair: (g=0): rw=randrw, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=16
...
fio-3.6
Starting 4 processes

rwx-fair: (groupid=0, jobs=4): err= 0: pid=10: Tue Feb  3 06:51:48 2026
   read: IOPS=501, BW=2008KiB/s (2056kB/s)(118MiB/60169msec)
    slat (nsec): min=1903, max=15644k, avg=47643.37, stdev=220590.00
    clat (usec): min=2, max=671445, avg=11128.32, stdev=25077.37
     lat (usec): min=306, max=671545, avg=11176.86, stdev=25075.66
    clat percentiles (usec):
     |  1.00th=[   379],  5.00th=[   586], 10.00th=[   840], 20.00th=[  1549],
     | 30.00th=[  2802], 40.00th=[  4817], 50.00th=[  7177], 60.00th=[  9896],
     | 70.00th=[ 13042], 80.00th=[ 16909], 90.00th=[ 22676], 95.00th=[ 29754],
     | 99.00th=[ 52167], 99.50th=[ 70779], 99.90th=[666895], 99.95th=[666895],
     | 99.99th=[675283]
   bw (  KiB/s): min=    7, max= 1176, per=27.36%, avg=549.05, stdev=199.05, samples=439
   iops        : min=    1, max=  294, avg=137.14, stdev=49.80, samples=439
  write: IOPS=219, BW=880KiB/s (901kB/s)(51.7MiB/60169msec)
    slat (usec): min=2, max=12405, avg=51.58, stdev=227.64
    clat (msec): min=11, max=3055, avg=263.19, stdev=284.49
     lat (msec): min=11, max=3055, avg=263.24, stdev=284.49
    clat percentiles (msec):
     |  1.00th=[   25],  5.00th=[   41], 10.00th=[   57], 20.00th=[  110],
     | 30.00th=[  190], 40.00th=[  234], 50.00th=[  262], 60.00th=[  284],
     | 70.00th=[  305], 80.00th=[  326], 90.00th=[  355], 95.00th=[  393],
     | 99.00th=[ 1653], 99.50th=[ 2802], 99.90th=[ 3037], 99.95th=[ 3037],
     | 99.99th=[ 3037]
   bw (  KiB/s): min=    7, max=  399, per=27.73%, avg=243.77, stdev=72.25, samples=433
   iops        : min=    1, max=   99, avg=60.79, stdev=18.07, samples=433
  lat (usec)   : 4=0.02%, 10=0.01%, 20=0.01%, 50=0.03%, 100=0.02%
  lat (usec)   : 250=0.08%, 500=2.00%, 750=3.60%, 1000=3.16%
  lat (msec)   : 2=7.95%, 4=8.54%, 10=16.52%, 20=17.98%, 50=11.33%
  lat (msec)   : 100=3.73%, 250=8.31%, 500=16.00%, 750=0.23%, 1000=0.03%
  fsync/fdatasync/sync_file_range:
    sync (nsec): min=24, max=6045.2k, avg=543.37, stdev=32316.98
    sync percentiles (nsec):
     |  1.00th=[    39],  5.00th=[    44], 10.00th=[    47], 20.00th=[    56],
     | 30.00th=[    74], 40.00th=[   114], 50.00th=[   147], 60.00th=[   179],
     | 70.00th=[   207], 80.00th=[   255], 90.00th=[   358], 95.00th=[   478],
     | 99.00th=[   764], 99.50th=[   908], 99.90th=[ 15808], 99.95th=[ 60160],
     | 99.99th=[798720]
  cpu          : usr=0.23%, sys=0.43%, ctx=43850, majf=0, minf=59
  IO depths    : 1=0.1%, 2=0.1%, 4=0.1%, 8=0.1%, 16=199.7%, 32=0.0%, >=64=0.0%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.1%, 32=0.0%, 64=0.0%, >=64=0.0%
     issued rwts: total=30204,13232,0,43376 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=16

Run status group 0 (all jobs):
   READ: bw=2008KiB/s (2056kB/s), 2008KiB/s-2008KiB/s (2056kB/s-2056kB/s), io=118MiB (124MB), run=60169-60169msec
  WRITE: bw=880KiB/s (901kB/s), 880KiB/s-880KiB/s (901kB/s-901kB/s), io=51.7MiB (54.2MB), run=60169-60169msec

===== pod/fio-rwx-test2-qcj6g =====
rwx-fair: (g=0): rw=randrw, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=16
...
fio-3.6
Starting 4 processes
rwx-fair: Laying out IO file (1 file / 1024MiB)

rwx-fair: (groupid=0, jobs=4): err= 0: pid=10: Tue Feb  3 06:51:57 2026
   read: IOPS=721, BW=2886KiB/s (2956kB/s)(169MiB/60037msec)
    slat (nsec): min=1820, max=16946k, avg=81932.06, stdev=257918.81
    clat (nsec): min=1386, max=189413k, avg=7177610.67, stdev=9189604.44
     lat (usec): min=76, max=189621, avg=7261.14, stdev=9206.02
    clat percentiles (usec):
     |  1.00th=[   106],  5.00th=[   245], 10.00th=[   453], 20.00th=[  1004],
     | 30.00th=[  1713], 40.00th=[  2606], 50.00th=[  3851], 60.00th=[  5866],
     | 70.00th=[  8586], 80.00th=[ 12387], 90.00th=[ 17433], 95.00th=[ 22938],
     | 99.00th=[ 39060], 99.50th=[ 47973], 99.90th=[ 76022], 99.95th=[129500],
     | 99.99th=[166724]
   bw (  KiB/s): min=   48, max= 2200, per=24.99%, avg=721.10, stdev=437.04, samples=480
   iops        : min=   12, max=  550, avg=180.18, stdev=109.29, samples=480
  write: IOPS=313, BW=1255KiB/s (1285kB/s)(73.6MiB/60037msec)
    slat (usec): min=2, max=8339, avg=86.64, stdev=237.08
    clat (msec): min=12, max=560, avg=186.39, stdev=115.77
     lat (msec): min=12, max=560, avg=186.48, stdev=115.77
    clat percentiles (msec):
     |  1.00th=[   26],  5.00th=[   41], 10.00th=[   54], 20.00th=[   70],
     | 30.00th=[   88], 40.00th=[  109], 50.00th=[  161], 60.00th=[  243],
     | 70.00th=[  279], 80.00th=[  305], 90.00th=[  338], 95.00th=[  359],
     | 99.00th=[  426], 99.50th=[  464], 99.90th=[  542], 99.95th=[  550],
     | 99.99th=[  558]
   bw (  KiB/s): min=   16, max=  856, per=24.93%, avg=312.93, stdev=178.25, samples=480
   iops        : min=    4, max=  214, avg=78.11, stdev=44.57, samples=480
  lat (usec)   : 2=0.07%, 4=0.17%, 10=0.01%, 20=0.02%, 50=0.07%
  lat (usec)   : 100=0.29%, 250=2.96%, 500=4.04%, 750=3.24%, 1000=3.01%
  lat (msec)   : 2=9.55%, 4=12.05%, 10=16.03%, 20=13.22%, 50=7.20%
  lat (msec)   : 100=8.73%, 250=7.79%, 500=11.47%, 750=0.09%
  fsync/fdatasync/sync_file_range:
    sync (nsec): min=24, max=1165.1k, avg=279.02, stdev=6948.16
    sync percentiles (nsec):
     |  1.00th=[    40],  5.00th=[    45], 10.00th=[    52], 20.00th=[    74],
     | 30.00th=[   106], 40.00th=[   131], 50.00th=[   151], 60.00th=[   171],
     | 70.00th=[   189], 80.00th=[   207], 90.00th=[   255], 95.00th=[   330],
     | 99.00th=[   548], 99.50th=[   660], 99.90th=[ 10816], 99.95th=[ 44800],
     | 99.99th=[288768]
  cpu          : usr=0.23%, sys=0.58%, ctx=83770, majf=0, minf=58
  IO depths    : 1=0.1%, 2=0.1%, 4=0.1%, 8=0.1%, 16=199.8%, 32=0.0%, >=64=0.0%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.1%, 32=0.0%, 64=0.0%, >=64=0.0%
     issued rwts: total=43322,18842,0,62104 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=16

Run status group 0 (all jobs):
   READ: bw=2886KiB/s (2956kB/s), 2886KiB/s-2886KiB/s (2956kB/s-2956kB/s), io=169MiB (177MB), run=60037-60037msec
  WRITE: bw=1255KiB/s (1285kB/s), 1255KiB/s-1255KiB/s (1285kB/s-1285kB/s), io=73.6MiB (77.2MB), run=60037-60037msec
